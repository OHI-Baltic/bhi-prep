## 2. Data

**Rainbow trout production (Denmark, Sweden and Finland) and Finfish (Denmark, Germany, Sweden and Finland)**

```{r Preamble, echo = FALSE, include = FALSE, error = FALSE}
source(file.path(here::here(), "R", "setup.R"))
# source(file.path(here::here(), "R", "data.R"))
```

### 2.1 Datasets with Sources

**Rainbow trouts mariculture**  

- **Sweden**
<!-- dataset save location BHI_share/2.0/Goals/FP/Mariculture/rb_trout/rbt_swe -->

```{r echo = FALSE, results = "asis"}
tab <- t(data.frame(
  c("PDF:", "Vattenbruk 2018"), 
  c("Location data:", "Page 7, table A")))

colnames(tab) <- c("Option", "Specification")
rownames(tab) <- NULL

knitr::kable(tab, caption = "Source: [Jorbruksverket database](https://www.scb.se/hitta-statistik/statistik-efter-amne/jord-och-skogsbruk-fiske/vattenbruk/vattenbruk/) <br/> [Jorbruksverket](https://www.scb.se/contentassets/cef2fb103630496bb532e76c98f747e6/jo1201_2018a01_sm_jo60sm1901.pdf) Downloaded 2019-10-09 by Andrea De Cervo")
```

<br/>

- **Denmark**
<!-- dataset save location BHI_share/2.0/Goals/FP/Mariculture/rb_trout/rbt_den -->

```{r echo = FALSE, results = "asis"}
tab <- t(data.frame(
  c("Faste tabeller med akvakulturststistik:", "Produktion af hovedarter fordelt på region"), 
  c("Rows:", "Regnbueørred, Saltvand")))

colnames(tab) <- c("Option", "Specification")
rownames(tab) <- NULL

knitr::kable(tab, caption = "Source: [Ministry of Environment and Food of Denmark database](https://fiskeristyrelsen.dk/fiskeristatistik/akvakulturstatistik/) <br/> Downloaded 2019-10-11 by Andrea De Cervo")
```

<br/>

- **Finland**
<!-- dataset save location BHI_share/2.0/Goals/FP/Mariculture/rb_trout/rbt_fin -->

```{r echo = FALSE, results = "asis"}
tab <- t(data.frame(
  c("Luke statistics database:", "Food fish production by species"), 
  c("Production:", "Quantity (1 000 kg)"),
  c("Area:", "Sea"),
  c("Fish:", "Rainbow trout"),
  c("Year:", "All")))

colnames(tab) <- c("Option", "Specification")
rownames(tab) <- NULL

knitr::kable(tab, caption = "Source: [Natural Resources Institute database](http://statdb.luke.fi/PXWeb/pxweb/en/LUKE/LUKE__06%20Kala%20ja%20riista__02%20Rakenne%20ja%20tuotanto__10%20Vesiviljely/?tablelist=true&rxid=ef8a2896-d6cb-4660-a8aa-fee93bd4212f) <br/> Downloaded 2019-10-10 by Andrea De Cervo")
```

<br/>

- **Germany**
<!-- dataset save location BHI_share/2.0/Goals/FP/Mariculture/rb_trout/rbt_ger -->

```{r echo = FALSE, results = "asis"}
tab <- t(data.frame(
  c("Location:", "Kiel Bay")))

colnames(tab) <- c("Option", "Specification")
rownames(tab) <- NULL

knitr::kable(tab, caption = "Source: [Email from plant manager](tassilo@jaeger-kleinicke.de) <br/> Received 2019-10-30")
```

<br/>

**Finfish Mariculture**  
<!-- dataset save location BHI_share/2.0/Goals/FP/Mariculture/Finfish_mariculture -->

```{r echo = FALSE, results = "asis"}
tab <- t(data.frame(
  c("HELCOM Map and Data service:", "Pressures and human activities"), 
  c("Human activities:", "Finfish mariculture")))

colnames(tab) <- c("Option", "Specification")
rownames(tab) <- NULL

knitr::kable(tab, caption = "Source: [HELCOM database](http://maps.helcom.fi/website/mapservice/?datasetID=3cfa469a-6a78-4913-b82f-57fd0e7f4dc0) <br/> (http://metadata.helcom.fi/geonetwork/srv/eng/catalog.search#/metadata/3cfa469a-6a78-4913-b82f-57fd0e7f4dc0) <br/> Downloaded 2019-10-09 by Andrea De Cervo")
```

<br/>

**All Baltic countries**
<!-- dataset save location BHI_share/2.0/Goals/FP/Mariculture/FAO_fishstat -->

```{r echo = FALSE, results = "asis"}
tab <- t(data.frame(
  c("FAO FishStatJ:", "Global aquaculture production"), 
  c("Quantity:", "1950-2017")))

colnames(tab) <- c("Option", "Specification")
rownames(tab) <- NULL

knitr::kable(tab, caption = "Source: [FAO FishStatJ](http://www.fao.org/fishery/statistics/software/fishstatj/en#downlApp) <br/> Downloaded 2019-10-16 by Andrea De Cervo")
```

<br/>

#### Reference Point: maximum nutrient discharge (N/P)

In 2016 HELCOM Contracting Parties adopted Recommendation 37/3 on "Sustainable aquaculture in the Baltic Sea Region" (http://www.helcom.fi/Recommendations/Rec%2037-3.pdf). 

However, the only parameter that can be used as reference point for Mariculture subgoal in the Baltic Sea (that can be also found on Finnish Mariculture data provided by HELCOM) is the maximum nutrient discharge for P and N (http://www.helcom.fi/Recommendations/Rec%2025-4.pdf), where existing and new marine fish farms should not exceed the annual average of: 
- 7g of P (tot-P) 
- 50g of N (tot-N) 
per 1kg fish (living weight) produced.
[The nutrient limit values (P and N) are calculated on the basis that living fish contains 0,4% of phosphorus and 2,75% of nitrogen.]

This recommendation was adopted in 2004, but since there are not updated nutrient limit values, this will be the parameter used as reference point.

### 2.2 Centralization & Normalization

```{r load raw data, message = FALSE, warning = FALSE, echo = TRUE}
## root location of the raw data
dir_rawdata <- file.path(dir_B, "Goals", "FP", "MAR") # list.files(dir_rawdata)

## rainbow trout data
library(readr)
rbt_de_raw <- read_delim(file.path(dir_rawdata, "rbt_de", "rbt_de.csv"), delim = ";")

rbt_dk_raw <- read_delim(file.path(dir_rawdata, "rbt_dk", "rbt_dk.csv"), delim = ";")
rbt_dk2005raw <- read_delim(file.path(dir_rawdata, "rbt_dk", "rbt_dk_2005.csv"), delim = ";")

rbt_fi_raw <- read_delim(file.path(dir_rawdata, "rbt_fi", "rbt_fi.csv"), delim = ";")
rbt_se_raw <- read_delim(file.path(dir_rawdata, "rbt_se", "rbt_se.csv"), delim = ";")

## FAO rainbow trout data
fao_rbt_raw <- read_delim(file.path(dir_rawdata, "FAO_fishstat", "FAO_fishstat.csv"), delim = ";")

# countrycodes for FAO dataset
countrycode <- data.frame(
  area = c("Germany", "Denmark", "Estonia", "Finland","Sweden"),
  country = c("DE", "DK", "ES", "FI", "SE")
)

## HELCOM Finfish mariculture data
finfish_mariculture_raw <- sf::st_read(file.path(dir_rawdata, # load library(sf)
  "Finfish_mariculture", "Finfish_mariculture.shp")) %>% 
  mutate(PR2011_TON = as.numeric(PR2011_TON),
         PR2012_TON = as.numeric(PR2012_TON),
         PR2013_TON = as.numeric(PR2013_TON),
         PR2014_TON = as.numeric(PR2014_TON),
         PR2015_TON = as.numeric(PR2015_TON),
         P_2011_KG = as.numeric(P_2011_KG),
         P_2012_KG = as.numeric(P_2012_KG),
         P_2013_KG = as.numeric(P_2013_KG),
         P_2014_KG = as.numeric(P_2014_KG),
         P_2015_KG = as.numeric(P_2015_KG),
         N_2011_KG = as.numeric(N_2011_KG),
         N_2012_KG = as.numeric(N_2012_KG),
         N_2013_KG = as.numeric(N_2013_KG),
         N_2014_KG = as.numeric(N_2014_KG),
         N_2015_KG = as.numeric(N_2015_KG))


    
```

#### 2.2.0 Merge datasets and calculate maximum nutrient discharge (N/P) 

```{r merge datasets and calculate max nutrient input, echo = TRUE}
combined_rawdata <- rbind(
  ## rbt_de
  rbt_de_raw %>% 
    dplyr::rename(farm_species = production) %>% 
    tidyr::gather(key = "area", value = "produced_tonnes", -year, -farm_species) %>%
    dplyr::mutate(produced_tonnes = as.numeric(produced_tonnes),
                  country = "DE",
                  p_kg = "",
                  n_kg = "",
                  # join with max nutrient input value
                  maxP_kg = 0.007*(as.numeric(produced_tonnes)*1000), 
                  maxN_kg = 0.05*(as.numeric(produced_tonnes)*1000)
    ) %>% 
    select(year, country, area, farm_species, produced_tonnes, p_kg, maxP_kg, n_kg, maxN_kg) %>% 
    arrange(country),
  ## rbt_dk2005 
  rbt_dk2005raw %>% 
    dplyr::select(-tot_wt_ton) %>% 
    dplyr::rename(
      farm_species = production,
      arhus_cty = cty1, 
      vejle_cty = cty2,
      fyns_cty = cty3,
      sønderjylland_cty = cty4,
      ribe_cty = cty5,
      ringkøbing_cty = cty6,
      viborg_cty = cty7,
      nordjyllands_cty = cty8,
      frederiksborg_cty = cty9,
      roskilde_cty = cty10,
      storstrøms_cty  = cty11,
      vestsjællands_cty = cty12
    ) %>% 
    tidyr::gather(key = "area", value = "produced_tonnes", -year, -farm_species) %>% 
    dplyr::mutate(country = "DK",
                  p_kg = "",
                  n_kg = "",
                  maxP_kg = 0.007*(as.numeric(produced_tonnes)*1000), 
                  maxN_kg = 0.05*(as.numeric(produced_tonnes)*1000)
    ) %>% 
    arrange(country),
  ## rbt_dk 
  rbt_dk_raw %>% 
    dplyr::rename(
      farm_species = production,
      denmark = tot_wt_ton,
      hovedstaden = "reg1", 
      sjælland = "reg2",
      syddanmark = "reg3",
      midtjylland = "reg4",
    ) %>% 
    tidyr::gather(key = "area", value = "produced_tonnes", -year, -farm_species) %>% 
    dplyr::mutate(country = "DK",
                  p_kg = "",
                  n_kg = "",
                  maxP_kg = 0.007*(as.numeric(produced_tonnes)*1000), 
                  maxN_kg = 0.05*(as.numeric(produced_tonnes)*1000)
    ) %>% 
    arrange(country),
  ## rbt_fi
  rbt_fi_raw %>% 
    dplyr::rename(
      produced_tonnes = tot_wt_tonnes, 
      farm_species = production) %>% 
    dplyr::mutate(country = "FI", area = "finland",
                  p_kg = "",
                  n_kg = "",
                  maxP_kg = 0.007*(as.numeric(produced_tonnes)*1000), 
                  maxN_kg = 0.05*(as.numeric(produced_tonnes)*1000)
    ) %>% 
    arrange(country),
  ## rbt_se
  rbt_se_raw %>% 
    dplyr::rename(
      farm_species = production,
      sweden = tot_wt_mtonnes) %>% 
    select(-ne_farm_no, -other_farm_no) %>%  # don't need these information 
    tidyr::gather(key = "area", value = "produced_tonnes", -year, -farm_species) %>% 
    mutate(country = "SE",
           p_kg = "",
           n_kg = "",
           maxP_kg = 0.007*(as.numeric(produced_tonnes)*1000), 
           maxN_kg = 0.05*(as.numeric(produced_tonnes)*1000)
    ) %>% 
    arrange(country),
  ## fao_rbt
  fao_rbt_raw %>% 
    dplyr::rename(
      area = country,
      farm_species = species) %>% 
    filter(farm_species == "Rainbow trout", 
           !(environment == "Marine" & area == "Denmark")) %>% 
    select(-aqua_area, -Unit, -environment, -("1950":"1971")) %>%
    tidyr::gather(key = "year", value = "produced_tonnes", -area, -farm_species) %>% 
    # remove characters from production
    mutate(produced_tonnes = str_replace(produced_tonnes,"F"," "),
           produced_tonnes = as.numeric(produced_tonnes),
           p_kg = "",
           n_kg = "",
           maxP_kg = 0.007*(as.numeric(produced_tonnes)*1000), 
           maxN_kg = 0.05*(as.numeric(produced_tonnes)*1000)
    ) %>% 
    # join with countrycode data
    left_join(countrycode, by = "area") %>% 
    arrange(country),
  ## finfish mariculture
  finfish_mariculture_raw %>%
    # remove 'geometry' column
   sf::st_drop_geometry() %>% 
    mutate(SUBBASIN = as.character(SUBBASIN), COUNTY = as.character(COUNTY)) %>% 
    mutate(SUBBASIN = ifelse(is.na(SUBBASIN), COUNTY, SUBBASIN)) %>% 
    dplyr::rename(
      area = SUBBASIN,
      farm_species = PRODUCTION,
      country = COUNTRY,
    ) %>% 
    # remove the facilities on land
    filter(is.na(AREA) | !str_detect(AREA, "On land")) %>% 
    filter(is.na(AREA) | !str_detect(AREA, "on land")) %>% 
    # replace NA value with more general mariculture name (finfish)
    mutate(farm_species = as.character(farm_species)) %>% 
    mutate(farm_species = ifelse(is.na(farm_species), "finfish", farm_species)) %>% 
    # gather the three variables (production, p, n) by year
    tidyr::gather(PRyear, produced_tonnes, PR2011_TON:PR2015_TON) %>% 
    mutate(year = str_extract(PRyear, pattern = "[0-9]{4}")) %>% 
    tidyr::gather(Pyear, p_kg, P_2011_KG:P_2015_KG) %>% 
    mutate(year = str_extract(Pyear, pattern = "[0-9]{4}")) %>% 
    tidyr::gather(Nyear, n_kg, N_2011_KG:N_2015_KG) %>% 
    mutate(year = str_extract(Nyear, pattern = "[0-9]{4}")) %>% 
    select(-COUNTY, -NAME, -COMMENTS, -AREA, -PR_AV_TON, -PR_SUM_TON, 
           -P_SUM_TON, -P_AV_TON, -N_SUM_TON, -N_AV_TON, -PRyear, -Pyear, -Nyear
    ) %>% 
    mutate(maxP_kg = 0.007*(as.numeric(produced_tonnes)*1000), 
           maxN_kg = 0.05*(as.numeric(produced_tonnes)*1000)) %>% 
    arrange(country))
    
```

#### 2.2.1 Standardize Units

#### 2.2.2 Rename Fields/Variables

#### 2.2.3 Save to BHI Database

<br/>

### 2.3 Initial Data Exploration

```{r}
## Create the datasets for the plots
# Plot format nutrient reference

plot_format_nutrients <- combined_rawdata %>% 
  dplyr::select(year, country, area, produced_tonnes, p_kg, maxP_kg, n_kg, maxN_kg) %>% 
  tidyr::gather(key = input, value = value, -year, -country, -area, -produced_tonnes)

nutrients_plot <- ggplot(data = plot_format_nutrients)  +
  geom_abline(slope = 0, intercept = 1, color = "grey40") +
  geom_line(aes(x = year, y = value, color = input), size = 0.5) +
  scale_color_brewer(palette = "Paired") +
  ylab("value \n")+
  facet_grid(~ vars(area)) + 
  theme(legend.position = "none")

```

```{r}
### Initial data exploration by national data first
## Checking all variables before plotting them

# Germany
str(rbt_de_raw)
germany <- rbt_de_raw %>% 
    dplyr::rename(farm_species = production) %>% 
    tidyr::gather(key = "area", value = "produced_tonnes", -year, -farm_species) %>%
    dplyr::mutate(produced_tonnes = as.numeric(produced_tonnes),
                  farm_species = as.factor(farm_species),
                  year = as.factor(year),
                  area = as.factor(area),
                  country = as.factor("DE"),
                  p_kg = as.numeric(""),
                  n_kg = as.numeric(""),
                  # join with max nutrient input value
                  maxP_kg = 0.007*(as.numeric(produced_tonnes)*1000), 
                  maxN_kg = 0.05*(as.numeric(produced_tonnes)*1000)
    ) %>% 
    select(year, country, area, farm_species, produced_tonnes, p_kg, maxP_kg, n_kg, maxN_kg) %>% 
    arrange(country)
str(germany)

# Plot the fish production
ggplot2::ggplot(germany) +
  geom_col(aes(year,produced_tonnes, fill = area)) +
  ggtitle("German production (tons) 2009-2019")
```

```{r}
# Denmark
denmark <- rbind(
  rbt_dk2005raw %>% 
    dplyr::select(-tot_wt_ton) %>% 
    dplyr::rename(
      farm_species = production,
      arhus_cty = cty1, 
      vejle_cty = cty2,
      fyns_cty = cty3,
      sønderjylland_cty = cty4,
      ribe_cty = cty5,
      ringkøbing_cty = cty6,
      viborg_cty = cty7,
      nordjyllands_cty = cty8,
      frederiksborg_cty = cty9,
      roskilde_cty = cty10,
      storstrøms_cty  = cty11,
      vestsjællands_cty = cty12
    ) %>% 
    tidyr::gather(key = "area", value = "produced_tonnes", -year, -farm_species) %>% 
    dplyr::mutate(country = as.factor("DK"),
                  produced_tonnes = as.numeric(produced_tonnes),
                  year = as.factor(year),
                  area = as.factor(area),
                  farm_species = as.factor(farm_species),
                  p_kg = as.numeric(""),
                  n_kg = as.numeric(""),
                  maxP_kg = 0.007*(as.numeric(produced_tonnes)*1000), 
                  maxN_kg = 0.05*(as.numeric(produced_tonnes)*1000)
    ) %>% 
    arrange(country),
  ## rbt_dk 
  rbt_dk_raw %>% 
    dplyr::rename(
      farm_species = production,
      denmark = tot_wt_ton,
      hovedstaden = "reg1", 
      sjælland = "reg2",
      syddanmark = "reg3",
      midtjylland = "reg4",
    ) %>% 
    tidyr::gather(key = "area", value = "produced_tonnes", -year, -farm_species) %>% 
    dplyr::mutate(country = as.factor("DK"),
                  produced_tonnes = as.numeric(produced_tonnes),
                  year = as.factor(year),
                  area = as.factor(area),
                  farm_species = as.factor(farm_species),
                  p_kg = as.numeric(""),
                  n_kg = as.numeric(""),
                  maxP_kg = 0.007*(as.numeric(produced_tonnes)*1000), 
                  maxN_kg = 0.05*(as.numeric(produced_tonnes)*1000)
    ) %>% 
    arrange(country))

str(denmark)

ggplot2::ggplot(denmark) +
  geom_col(aes(year,produced_tonnes, fill = area), position = position_dodge()) +
  coord_flip()
  ggtitle("Danish production (tons) 2005-2017")
```


```{r}
# Finland
finland <- rbt_fi_raw %>% 
  dplyr::rename(
    produced_tonnes = tot_wt_tonnes, 
    farm_species = production) %>% 
  dplyr::mutate(country = as.factor("FI"), area = "finland",
                produced_tonnes = as.numeric(produced_tonnes),
                year = as.factor(year),
                area = as.factor(area),
                farm_species = as.factor(farm_species),
                p_kg = as.numeric(""),
                n_kg = as.numeric(""),
                maxP_kg = 0.007*(as.numeric(produced_tonnes)*1000), 
                maxN_kg = 0.05*(as.numeric(produced_tonnes)*1000)
  ) %>% 
  arrange(country)

str(finland)

ggplot2::ggplot(finland) +
  geom_col(aes(year,produced_tonnes, fill = area)) +
  coord_flip()
  ggtitle("Finnish production (tons) 1978-2018")
```

```{r}
# Sweden 
sweden <- rbt_se_raw %>% 
  dplyr::rename(
    farm_species = production,
    sweden = tot_wt_mtonnes) %>% 
  select(-ne_farm_no, -other_farm_no) %>%  # don't need these information 
  tidyr::gather(key = "area", value = "produced_tonnes", -year, -farm_species) %>% 
  mutate(country = as.factor("SE"),
         produced_tonnes = as.numeric(produced_tonnes),
         year = as.factor(year),
         area = as.factor(area),
         farm_species = as.factor(farm_species),
         p_kg = as.numeric(""),
         n_kg = as.numeric(""),
         maxP_kg = 0.007*(as.numeric(produced_tonnes)*1000), 
         maxN_kg = 0.05*(as.numeric(produced_tonnes)*1000)
  ) %>% 
  arrange(country)

str(sweden)

ggplot2::ggplot(sweden) +
  geom_col(aes(year,produced_tonnes, fill = area), 
           position = position_dodge()) +
  coord_flip()
  ggtitle("Swedish production (tons) 2009-2018")
```


```{r}
# FAO
fao <- fao_rbt_raw %>% 
  dplyr::rename(
    area = country,
    farm_species = species) %>% 
  filter(farm_species == "Rainbow trout", 
         !(environment == "Marine" & area == "Denmark")) %>% 
  select(-aqua_area, -Unit, -environment, -("1950":"1971")) %>%
  tidyr::gather(key = "year", value = "produced_tonnes", -area, -farm_species) %>% 
  # remove characters from production
  mutate(produced_tonnes = str_replace(produced_tonnes,"F"," "),
         produced_tonnes = as.numeric(produced_tonnes),
         year = as.factor(year),
         area = as.factor(area),
         farm_species = as.factor(farm_species),
         p_kg = as.numeric(""),
         n_kg = as.numeric(""),
         maxP_kg = 0.007*(as.numeric(produced_tonnes)*1000), 
         maxN_kg = 0.05*(as.numeric(produced_tonnes)*1000)
  ) %>% 
  # join with countrycode data
  left_join(countrycode, by = "area") %>% 
  arrange(country)

str(fao)

ggplot2::ggplot(fao)+
  geom_col(aes(year,produced_tonnes, fill = area), position = position_dodge(), width = 2) +
  ggtitle("FAO Brackish water production (tons) 1972-2017")
```


```{r}
## root location of the raw data
dir_rawdata <- file.path(dir_B, "Goals", "FP", "MAR") # list.files(dir_rawdata)
## HELCOM Finfish mariculture data
finfish_mariculture_raw <- sf::st_read(file.path(dir_rawdata, # load library(sf)
  "Finfish_mariculture", "Finfish_mariculture.shp")) %>% 
  mutate(PR2011_TON = as.numeric(PR2011_TON),
         PR2012_TON = as.numeric(PR2012_TON),
         PR2013_TON = as.numeric(PR2013_TON),
         PR2014_TON = as.numeric(PR2014_TON),
         PR2015_TON = as.numeric(PR2015_TON),
         P_2011_KG = as.numeric(P_2011_KG),
         P_2012_KG = as.numeric(P_2012_KG),
         P_2013_KG = as.numeric(P_2013_KG),
         P_2014_KG = as.numeric(P_2014_KG),
         P_2015_KG = as.numeric(P_2015_KG),
         N_2011_KG = as.numeric(N_2011_KG),
         N_2012_KG = as.numeric(N_2012_KG),
         N_2013_KG = as.numeric(N_2013_KG),
         N_2014_KG = as.numeric(N_2014_KG),
         N_2015_KG = as.numeric(N_2015_KG))

# HELCOM
helcom <- finfish_mariculture_raw %>%
  # remove 'geometry' column
  sf::st_drop_geometry() %>% 
  mutate(SUBBASIN = as.character(SUBBASIN), COUNTY = as.character(COUNTY)) %>% 
  mutate(SUBBASIN = ifelse(is.na(SUBBASIN), COUNTY, SUBBASIN)) %>% 
  dplyr::rename(
    area = SUBBASIN,
    farm_species = PRODUCTION,
    country = COUNTRY,
  ) %>% 
  # remove the facilities on land
  filter(is.na(AREA) | !str_detect(AREA, "On land")) %>% 
  filter(is.na(AREA) | !str_detect(AREA, "on land")) %>% 
  # replace NA value with more general mariculture name (finfish)
  mutate(farm_species = as.character(farm_species)) %>% 
  mutate(farm_species = ifelse(is.na(farm_species), "finfish", farm_species)) %>% 
  mutate(area = str_replace(area,"Sland Sea","Aland Sea")) %>% 
  select(-COUNTY, -NAME, -COMMENTS, -AREA, -PR_AV_TON, -PR_SUM_TON, 
         -P_SUM_TON, -P_AV_TON, -N_SUM_TON, -N_AV_TON) %>% 
  tidyr::gather(key, value, PR2011_TON:N_2015_KG) %>% ## ERROR: rows should be 1595, not 4785! (If trying to gather only one group of columns, e.g. PR2011_TON:PR2015_TON, then it's 1595, but can't then merge the other groups and keep the same row no)
   mutate(
    year = str_extract(key, pattern = "[0-9]{4}"),
    var = str_extract(key, pattern = "[A-Z]+")
  ) %>% 
  tibble::rowid_to_column() %>%
  spread(var, value)  
  
 
```


#### 2.3.1 Compare versus Previous Years Data

#### 2.3.2 Timeseries Plots

#### 2.3.3 Map

